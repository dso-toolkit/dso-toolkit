@use "sass:math";

@use "@dso-toolkit/css/src/components/form/form.variables" as variables;

.form,
form,
.dso-section-body {
  .dso-justify-form-groups {
    display: flex;

    > div {
      flex: 1 1 0;
      padding-left: $u1;

      &:first-child {
        padding-left: 0;
      }

      &.dso-form-buttons {
        align-self: flex-end;
        flex: 0 0 0;
      }
    }

    .form-group {
      &,
      + .form-group,
      + .dso-form-buttons {
        margin-bottom: 0;
        margin-top: 0;
      }
    }
  }
}

.dso-form-buttons {
  @include clearfix();

  margin-bottom: $dso-vertical-spacing-medium;
  text-align: right;

  &:last-child {
    margin-bottom: $dso-vertical-spacing-xlarge;
  }
}

.form-group {
  &.dso-radios {
    &.dso-inline {
      .dso-selectable {
        @include selectable_inline(".dso-selectable");
      }
    }
  }

  &.dso-radios,
  &.dso-checkboxes,
  &.dso-confirm {
    &.dso-invalid {
      .dso-selectable {
        @include selectable_invalid();
      }
    }
  }

  &.dso-required {
    &.dso-checkboxes,
    &.dso-confirm,
    &.dso-files,
    &.dso-radios,
    &.dso-select,
    &.dso-textarea {
      .control-label::after {
        @include form-group-required();
      }
    }
  }

  textarea {
    resize: vertical;
  }
}

select:not([multiple]) {
  .form-group & {
    @include di-variant("caret-down");

    -moz-appearance: none;
    -webkit-appearance: none;
    background-position: calc(100% - #{$u1});
    background-repeat: no-repeat;
    background-size: $dso-icon-size $dso-icon-size;
    padding-right: $u4;

    &:disabled {
      @include di-variant("caret-down-disabled");
    }

    &::-ms-expand {
      display: none;
    }
  }

  .form-group.dso-invalid & {
    @include di-variant("caret-down-invalid");
  }
}

.form-horizontal {
  .form-group {
    &.dso-confirm {
      @media screen and (min-width: $screen-sm-min) {
        .dso-field-container {
          margin-left: percentage(math.div(variables.$dso-label-column, $grid-columns));
          padding-left: $grid-gutter-width * 0.5;
        }
      }
    }

    &.dso-static {
      .dso-field-container {
        margin-bottom: 0;
        min-height: $line-height-computed + $font-size-base;
        padding-bottom: $padding-base-vertical + 1;
        padding-top: $padding-base-vertical + 1;

        * {
          margin-bottom: 0;
          margin-top: 0;

          + * {
            margin-top: $dso-vertical-spacing-small;
          }
        }
      }

      &.dso-edit .dso-field-container {
        padding-right: $u5;
        position: relative;

        button {
          position: absolute;
          right: $u2;
          top: 0;
        }
      }
    }

    &.dso-textarea {
      .form-control {
        padding-bottom: $padding-base-vertical - 1;
        padding-top: $padding-base-vertical - 1;

        &:not([rows]) {
          height: calc(#{$line-height-base * variables.$dso-textarea-default-rows}em + #{($padding-base-vertical + 1) * 2});
        }
      }
    }

    &.dso-radios.dso-inline {
      .dso-selectable {
        margin-bottom: 0;
      }
    }

    @media screen and (min-width: $screen-sm-min) {
      &.dso-input-number,
      &.dso-checkboxes,
      &.dso-radios {
        .dso-field-container {
          padding-top: #{$padding-base-vertical + 1};
        }
      }
    }
  }
}

.control-label + .dso-info-button {
  @include info-button_controlLabelSibling();
}

/* stylelint-disable-next-line no-invalid-position-at-import-rule */
@import "./form/files";
