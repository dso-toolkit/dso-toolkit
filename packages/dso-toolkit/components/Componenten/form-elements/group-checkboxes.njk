{% set localId = generateLocalId(prefix, id ) %}

{% set infoTextId = 'infoTextId_' + id %}

{% if infoText and static %}
  {% set ariaDescribedBy = infoTextId %}
{% endif %}

<fieldset {{ className('form-group', 'dso-checkboxes', [state, 'dso-' + state], [required, 'dso-required']) }}
  {% if ariaDescribedBy %} aria-describedby="{{ ariaDescribedBy }}" {% endif %}>
  <legend class="sr-only">{{ label }}</legend>
  <div class="dso-label-container">
    <span class="control-label" aria-hidden="true">
      {{ label }}
    </span>
    {% if infoText and not static %}
      {% render '@info-button', {infoOpen: infoOpen, infoButtonLabel: infoButtonLabel} %}
    {% endif %}
    {% if infoOpen %}
      {% render '@info', {infoText: infoText, static: static, id: infoTextId} %}
    {% endif %}
  </div>
  <div class="dso-field-container">
    {% for option in options %}
      {% if option.nestedItems %}
        {% render '@nested-selectables', {
          type: 'checkbox',
          id: localId + '-' + loop.index0,
          name: id,
          value: option.value,
          label: option.label,
          disabled: option.disabled,
          checked: option.checked,
          required: option.required,
          invalid: state == 'invalid',
          infoText: option.infoText,
          infoOpen: option.infoOpen,
          infoButtonLabel: option.infoButtonLabel,
          infoStatic: option.static,
          nestedItems: option.nestedItems
        } %}
      {% else %}
        {% render '@selectable', {
          type: 'checkbox',
          id: localId + '-' + loop.index0,
          name: id,
          value: option.value,
          label: option.label,
          disabled: option.disabled,
          checked: option.checked,
          required: option.required,
          invalid: state == 'invalid',
          infoText: option.infoText,
          infoOpen: option.infoOpen,
          infoButtonLabel: option.infoButtonLabel,
          infoStatic: option.static
        } %}
      {% endif %}
    {% endfor %}
    {% if errorText %}
      {% render '@error-block', {errorText: errorText} %}
    {% endif %}
    {% if helpText %}
      {% render '@help-block', {helpText: helpText, id: localId} %}
    {% endif %}
  </div>
</fieldset>
